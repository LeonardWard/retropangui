#!/usr/bin/env bash

# =======================================================
# Retro Pangui Platform Configuration - Generic ARMv7
# 파일명: platforms/armv7l.conf
# 설명: 알 수 없는 ARMv7 (armv7l) 기기용 안전한 기본 설정
#
# ⚠️  주의: 이 파일은 fallback 용도입니다.
#    최적의 성능을 위해서는 기기별 설정 파일을 만드세요!
#
# 사용 용도:
# 1. 미지원 ARMv7 기기에서 강제 진행 시 기본값
# 2. 새 플랫폼 추가 시 복사할 템플릿
# =======================================================

# --- RetroArch 버전 설정 ---
RA_VERSION=""
RA_BRANCH="master"

# --- 활성화 코어 목록 ---
# 32bit ARM은 성능 제한적 - 기본 코어만
PLATFORM_ENABLED_CORES=(
    "${COMMON_ENABLED_CORES[@]}"
    "lr-pcsx-rearmed"       # PlayStation 1
)

# --- 비활성화 코어 목록 ---
PLATFORM_DISABLED_CORES=(
    "lr-dolphin"
    "lr-citra"
    "lr-ppsspp"
    "lr-mupen64plus-next"
    "lr-flycast"
    "lr-beetle-psx-hw"
)

# --- 빌드 옵션 ---
# Generic ARMv7-A + NEON (대부분의 ARMv7 지원)
PLATFORM_CFLAGS="-march=armv7-a -mfpu=neon-vfpv4 -mfloat-abi=hard"
PLATFORM_LDFLAGS=""
PLATFORM_MAKEFLAGS="-j$(nproc)"

# --- GPU 백엔드 설정 ---
USE_OPENGL="no"
USE_GLES="yes"          # OpenGL ES 2.0
USE_VULKAN="no"         # ARMv7은 대부분 Vulkan 미지원
USE_KMS="yes"
USE_WAYLAND="no"
USE_X11="no"

# --- 최적화 레벨 ---
OPT_LEVEL="-O2"

# --- RetroArch configure 옵션 ---
RA_CONFIGURE_OPTS=(
    "--prefix=$INSTALL_ROOT_DIR"
    "--disable-x11"
    "--disable-wayland"
    "--disable-opengl"
    "--enable-opengles"
    "--enable-kms"
    "--enable-egl"
    "--enable-udev"
    "--enable-alsa"
    "--enable-threads"
    "--enable-ffmpeg"
    "--enable-7zip"
    "--enable-sdl2"
    "--enable-neon"
)

# --- 추가 환경 변수 ---
export CFLAGS="$PLATFORM_CFLAGS $OPT_LEVEL"
export CXXFLAGS="$PLATFORM_CFLAGS $OPT_LEVEL"
